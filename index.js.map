{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst listElement = document.querySelector(\".gallery\");\nconst loaderEl = document.querySelector('.display-loader');\nconst showButton = document.querySelector('.load-more');\n\nfunction createGallery(images) {\n    const gallery =  images.map(({ \n            tags, \n            likes, \n            views, \n            comments, \n            downloads, \n            webformatURL,\n            largeImageURL }) => \n            \n        `<li class=\"gallery-item\">\n            <a href=\"${largeImageURL}\">\n                <img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\"\n                />\n                <div class=\"notes\">\n                <div class=\"description\">\n                    <h2 class=\"title\">Likes</h2>\n                    <p class=\"amount\">${likes}</p>\n                </div>\n                <div class=\"description\">\n                    <h2 class=\"title\">Views</h2>\n                    <p class=\"amount\">${views}</p>\n                </div>\n                <div class=\"description\">\n                    <h2 class=\"title\">Comments</h2>\n                    <p class=\"amount\">${comments}</p>\n                </div>\n                <div class=\"description\">\n                    <h2 class=\"title\">Downloads</h2>\n                    <p class=\"amount\">${downloads}</p>\n                </div>\n            </div>\n            </a>\n            \n        </li>`).join(\"\");\n\n    listElement.insertAdjacentHTML(\"beforeend\", gallery);\n\n    let lightbox = new SimpleLightbox('.gallery a', {\n        captionsData: 'alt',\n        captionPosition: 'bottom',\n        captionDelay: 250,\n    });\n    lightbox.on('show.simplelightbox');\n\n    lightbox.refresh();\n}\n\nfunction clearGallery() {\n    listElement.innerHTML=\"\";\n}\n\nfunction showLoader() {\n    loaderEl.classList.remove('is-hidden');\n}\n\nfunction hideLoader() {\n    loaderEl.classList.add('is-hidden');\n}\n\nfunction showLoadMoreButton() {\n    showButton.classList.remove('is-hidden');\n}\n\nfunction hideLoadMoreButton(){\n    showButton.classList.add('is-hidden');\n}\n\nexport { listElement, showButton, createGallery, clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton }","import axios from 'axios';\nimport { showLoadMoreButton } from './render-functions';\n\nconst API_KEY = '50797818-4d1ec28dd028369cf30507a0a';\nconst link = 'https://pixabay.com/api/';\n\nexport async function getImagesByQuery(query, page = 1, quantity = 1){\n\n    const result = await axios(link, {\n        params: {\n            key: API_KEY,\n            q: query,\n            image_type: 'photo',\n            orientation: 'horizontal',\n            safesearch: true,\n            per_page: quantity,\n            page,\n        },\n    })\n        \n    return result.data;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        \n// return response.data;\n        \n    // return await axios\n    //     .get(link, {\n    //     params: {\n    //         key: API_KEY,\n    //         q: query,\n    //         image_type: 'photo',\n    //         orientation: 'horizontal',\n    //         safesearch: true,\n    //         per_page: 9,\n    //         page: 1,\n    //     },\n    //     })\n    //     .then(response => {\n    //         console.log(response);\n            \n    //         if(response.data.hits.length === 0){\n    //             throw new Error(message);\n    //         }\n            \n    //         return response.data.hits;\n    //     })\n    //     .catch(error => {\n\n    //     return null;\n    //     });\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getImagesByQuery } from \"./js/pixabay-api\"\nimport { createGallery, clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton, showButton, listElement } from \"./js/render-functions\";\n\nconst formEl = document.querySelector(\".form\");\n\nlet imgOnPage = 15;\nlet currentPage = 1;\nlet query = \"\";\nlet totalPages = 0;\n\nformEl.addEventListener(\"submit\", handleForm);\n\nasync function handleForm(event) {\n    event.preventDefault();\n    \n    currentPage = 1;\n    clearGallery();\n    showLoader();\n\n    query = event.currentTarget.elements.searchText.value.trim();\n\n    if(!query){\n        iziToast.error({\n            backgroundColor: \"#ef4040\",\n            timeout: 2000,\n            position: \"topRight\",\n            message: \"Sorry, you have to make a choice!\",\n        });\n            hideLoader();\n            hideLoadMoreButton();\n            formEl.reset();\n            return;\n    }\n    try{\n        const data = await getImagesByQuery(query, currentPage, imgOnPage);\n            \n        if(data.hits.length === 0){\n            throw new Error(message);\n        }\n\n        totalPages = Math.ceil(data.totalHits / imgOnPage);\n\n        if(currentPage === totalPages){\n            iziToast.info({\n                backgroundColor: \"#41bbbb\",\n                timeout: 2000,\n                position: \"topRight\",\n                message: \"There's only one part in this query.\",\n            });\n            \n            hideLoadMoreButton();\n            createGallery(data.hits);\n        } else {\n            createGallery(data.hits);\n            showLoadMoreButton();\n        }        \n    }\n        \n    catch(error) {\n            iziToast.error({\n                backgroundColor: \"#ef4040\",\n                timeout: 2000,\n                position: \"topRight\",\n                message: \"Sorry, there are no images matching your search query. Please try again!\",\n            });\n            \n            hideLoadMoreButton()\n            formEl.reset();\n        }\n\n    finally{\n            hideLoader();\n            formEl.reset();\n        }\n}\n\nshowButton.addEventListener('click', handleClick);\n\nasync function handleClick() {\n    currentPage += 1;\n    hideLoadMoreButton();\n    showLoader();\n\n    try {\n        if(currentPage > totalPages){\n            iziToast.info({\n                backgroundColor: \"#41bbbb\",\n                timeout: 2000,\n                position: \"topRight\",\n                message: \"We're sorry, but you've reached the end of search results.\",\n            });\n            \n            hideLoadMoreButton();\n            return;\n        }\n        showLoadMoreButton();\n\n        const data = await getImagesByQuery(query, currentPage, imgOnPage);\n\n        createGallery(data.hits);\n\n        const heighElement = listElement.firstChild.getBoundingClientRect().height;\n\n        window.scrollBy({\n            top: heighElement * 2,\n            behavior: 'smooth'\n        })        \n    }\n\n    catch(error) {\n        iziToast.error({\n            backgroundColor: \"#ef4040\",\n            timeout: 2000,\n            position: \"topRight\",\n            message: error.message,\n        });            \n    }\n\n    finally{\n        hideLoader();\n    }\n}\n"],"names":["listElement","loaderEl","showButton","createGallery","images","gallery","tags","likes","views","comments","downloads","webformatURL","largeImageURL","lightbox","SimpleLightbox","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","API_KEY","link","getImagesByQuery","query","page","quantity","axios","formEl","imgOnPage","currentPage","totalPages","handleForm","event","iziToast","data","handleClick","heighElement","error"],"mappings":"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"}